{#-- Global footer --#}

{# -- Register Google Tag Manager -- #}
{%- if not craft.app.config.general.devMode -%}
    <script>
        // Define dataLayer and the gtag function.
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments)}

        // Default ad_storage to 'denied'.
            {# 'ad_storage': 'denied' #}
        gtag('consent', 'default', {
            'analytics_storage': 'denied',
            'ad_storage': 'denied',
        })
    </script>

    <!-- Google Tag Manager -->
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
        new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
        j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
        'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
        })(window,document,'script','dataLayer', '{{- getenv('GTM_TRACKING_ID') -}}');
    </script>
    <!-- End Google Tag Manager -->

    <!-- enable analytics when "ad_user_data" category is selected -->
    <script type="text/plain" data-category="analytics">
        gtag('consent', 'update', {
            'analytics_storage': 'granted'
        })
    </script>

    <!-- enable ads when "ads" category is selected -->
    <script type="text/plain" data-category="marketing">
        gtag('consent', 'update', {
            'ad_storage': 'granted'
        });
    </script>
{%- endif -%}

{#-- Browser fixes --#}
<!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
    <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
<![endif]-->